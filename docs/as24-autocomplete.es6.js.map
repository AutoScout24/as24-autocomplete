{"version":3,"file":"as24-autocomplete.es6.js","sources":["../src/as24-autocomplete-input.js","../src/data-sources/tags-data-source.js","../src/as24-autocomplete.js"],"sourcesContent":["'use strict';\n\n/**\n * Finds a closest element by class name\n * @param className\n */\nconst closestByClassName = className => elem =>\n    elem.classList.contains(className)\n        ? elem\n        : closestByClassName(className)(elem.parentElement);\n\n/**\n * Selects an element using the root element.\n * @param {string} selector\n * @param {Element} root\n */\nconst $ = (selector, root) => root.querySelector(selector);\n\n/**\n * Binds an event listener on the element\n * @param {string} event\n * @param {Function} cb\n * @param {Element} el\n * @param {boolean} capturing\n */\nconst on = (event, cb, el, capturing = false) => el.addEventListener(event, cb, capturing);\n\n/**\n * Appends a child element to a target element\n * @param target\n */\nconst appendTo = target => child => {\n    target.appendChild(child);\n    return target;\n};\n\n/**\n * Shows the suggestions list\n * @param {Element} list\n * @return {boolean}\n */\nconst showList = list => {\n    list.classList.add('as24-autocomplete__list--visible');\n    moveSelection(1, list);\n    return false;\n};\n\n/**\n * Hides the list and deactivates the root elment\n * @param {Element} list\n * @param {Element} rootElement\n */\nconst hideList = (list, rootElement) => e => {\n    rootElement.classList.remove('as24-autocomplete--active');\n    list.classList.remove('as24-autocomplete__list--visible');\n    return false;\n};\n\n/**\n * Checks whether the list is visisible\n * @param {Element} list\n */\nconst isListVisible = list =>\n    list.classList.contains('as24-autocomplete__list--visible');\n\n/**\n * Renders a li item for the suggestions list\n * @param {string} searchStr\n * @returns {HTMLElement} {Element}\n */\nconst renderLI = searchStr => item => {\n    const li = document.createElement('li');\n    const searchValue = searchStr;\n    const resultValue = item.value.replace(new RegExp('^' + searchValue, 'gi'), '');\n    li.classList.add('as24-autocomplete__list-item');\n    li.key = item.key;\n    (li.innerHTML = searchStr.length\n        ? '<strong>' + searchValue + '</strong>' + resultValue\n        : resultValue);\n    return li;\n};\n\n/**\n * What to render when there is nothing to suggest\n * @param {String} emptyMessage\n * @return {Element}\n */\nconst renderEmptyListItem = emptyMessage => {\n    const li = document.createElement('li');\n    li.classList.add('as24-autocomplete__list-item');\n    li.key = '';\n    li.innerText = emptyMessage;\n    return li;\n};\n\n/**\n * Renders a collection of raw suggestions to the list\n * @param {string} emptyMessage\n * @param {HTMLElement} list\n * @param {HTMLInputElement} labelInput\n * @returns {Function}\n */\nconst renderList = (emptyMessage, list, labelInput) => itemsModel => {\n    list.innerHTML = '';\n    const df = document.createDocumentFragment();\n\n    (itemsModel.length\n        ? itemsModel.map(renderLI(labelInput.value))\n        : [renderEmptyListItem(emptyMessage)]\n    ).forEach(appendTo(df));\n\n    list.classList[itemsModel.length ? 'remove' : 'add']('as24-autocomplete__list--empty');\n    appendTo(list)(df);\n    showList(list);\n};\n\n/**\n * Fetch data according to user input and renders the list\n * @param {Element} dataSource\n * @param {HTMLInputElement} labelInput\n * @param {Element} list\n * @param {String} emptyMessage\n * @param {Element} rootElement\n */\nconst fetchList = (dataSource, labelInput, list, emptyMessage, rootElement) => e => {\n    e.stopPropagation();\n    rootElement.classList.add('as24-autocomplete--active');\n    dataSource.fetchItems(labelInput.value).then(renderList(emptyMessage, list, labelInput));\n};\n\n/**\n * This is what happens after the user selected an item\n * @param valueInput\n * @param labelInput\n * @param li\n */\nconst selectItem = (valueInput, labelInput, li) => {\n    valueInput.value = li.key;\n    labelInput.value = li.innerText;\n};\n\n/**\n * This is what happens then user clicked in the suggestion item\n * @param valueInput\n * @param labelInput\n * @param list\n * @param rootElement\n */\nconst onItemClicked = (valueInput, labelInput, list, rootElement) => e => {\n    selectItem(valueInput, labelInput, closestByClassName('as24-autocomplete__list-item')(e.target));\n    hideList(list, rootElement)(e);\n};\n\n/**\n *\n * @param {HTMLElement} list\n * @param {HTMLElement} selected\n */\nconst followSelectedItem = (list, selected) => {\n    const listHeight = list.getBoundingClientRect().height;\n    const selectedTop = selected.offsetTop;\n    const selectedHeight = selected.offsetHeight;\n    list.scrollTop = -1 * (listHeight - (selectedTop + selectedHeight));\n};\n\n/**\n * When mouse goes over the suggestion item\n * @param list\n */\nconst onItemMouseOver = list => e => {\n    e.stopPropagation();\n    const preselected = $('.as24-autocomplete__list-item--preselected', list);\n    if (e.target.tagName === 'LI') {\n        if(preselected) {\n            preselected.classList.remove('as24-autocomplete__list-item--preselected');\n        }\n        e.target.classList.add('as24-autocomplete__list-item--preselected');\n    }\n};\n\n/**\n * Selected next/prev suggestion item\n * @param {number} dir\n * @param {Element} list\n * @return {boolean}\n */\nconst moveSelection = (dir, list) => {\n    const next = dir === 1 ? 'nextSibling' : 'previousSibling';\n    const currActiveItem = $('.as24-autocomplete__list-item--selected', list);\n    const nextActiveItem = currActiveItem === null\n        ? $('.as24-autocomplete__list-item', list)\n        : !!currActiveItem[next]\n        ? currActiveItem[next]\n        : currActiveItem;\n    currActiveItem && currActiveItem.classList.remove('as24-autocomplete__list-item--selected');\n    nextActiveItem.classList.add('as24-autocomplete__list-item--selected');\n    followSelectedItem(list, nextActiveItem);\n    return false;\n};\n\n/**\n * Handles key down\n * @param dataSource\n * @param valueInput\n * @param labelInput\n * @param list\n * @param rootElement\n */\nconst onKeyDown = (dataSource, valueInput, labelInput, list, rootElement) => e => {\n    if (e.target === labelInput) {\n        if ([38, 40, 27].indexOf(e.which) >= 0) {\n            e.stopPropagation();\n            e.preventDefault();\n        }\n        if (e.which === 38) {\n            return moveSelection(-1, list);\n        }\n        if (e.which === 40) {\n            return isListVisible(list) ? moveSelection(1, list) : showList(list);\n        }\n        if (e.which === 27) {\n            return hideList(list, rootElement)();\n        }\n    }\n};\n\n/**\n * Handles key up\n * @param dataSource\n * @param valueInput\n * @param labelInput\n * @param list\n * @param emptyListMessage\n * @param rootElement\n */\nconst onKeyUp = (dataSource, valueInput, labelInput, list, emptyListMessage, rootElement) => e => {\n    e.stopPropagation();\n    if (e.which === 13) {\n        selectItem(valueInput, labelInput, $('.as24-autocomplete__list-item--selected', list));\n        hideList(list, rootElement)();\n        return;\n    }\n    if ([38, 40, 27].indexOf(e.which) === -1) {\n        return fetchList(dataSource, labelInput, list, emptyListMessage, rootElement)(e);\n    }\n};\n\nfunction elementAttached() {\n    const root = this;\n    const emptyListMessage = root.getAttribute('empty-list-message') || \"---\";\n    const dataSourceName = root.getAttribute('data-source');\n    if (!dataSourceName) {\n        throw \"The data source is missing\";\n    }\n    const labelInput = $('[type=text]', root);\n    const valueInput = $('[type=hidden]', root);\n    const list = $('.as24-autocomplete__list', root);\n    const arrow = $('.as24-autocomplete__icon-wrapper', root);\n\n    const dataSource = $('#' + dataSourceName, document);\n\n    if(arrow) {\n        on('click', (e) => {\n            e.stopPropagation();\n            if(isListVisible(list)) {\n                hideList(list, root)(e)\n            } else {\n                labelInput.focus();\n                fetchList(dataSource, labelInput, list, emptyListMessage, root)(e);\n            }\n        }, arrow);\n    }\n\n    on('click', hideList(list, root), document);\n    on('click', fetchList(dataSource, labelInput, list, emptyListMessage, root), labelInput);\n    on('click', onItemClicked(valueInput, labelInput, list, root), list);\n    on('keyup', onKeyUp(dataSource, valueInput, labelInput, list, emptyListMessage, root), labelInput);\n    on('keydown', onKeyDown(dataSource, valueInput, labelInput, list, root), window);\n    on('mouseover', onItemMouseOver(list), list, true);\n}\n\nfunction elementDetached() {\n}\n\nexport default function () {\n    try {\n        return document.registerElement('as24-autocomplete', {\n            prototype: Object.assign(\n                Object.create(HTMLElement.prototype, {\n                    attachedCallback: {value: elementAttached},\n                    detachedCallback: {value: elementDetached},\n                    attributeChangedCallback: {\n                        value: function () {\n                        }\n                    }\n                })\n            )\n        });\n    } catch (e) {\n        if (window && window.console) {\n            window.console.warn('Failed to register CustomElement \"as24-autocomplete\".', e);\n            return null;\n        }\n    }\n}\n","var itemsCache = {};\n\nconst extractKeyValues = root =>\n  Array.prototype.slice.call(root.querySelectorAll('item')).map(tag => ({\n      key: tag.getAttribute('key'),\n      value: tag.getAttribute('value')\n  }));\n\nconst valuePredicate = queryString => item =>\n  item.value.match(new RegExp('^' + queryString, 'ig')) !== null;\n\nfunction fetchItems(queryString) {\n    var root = this;\n    var thisID = root.id;\n    return new Promise(res => {\n        itemsCache[thisID] = itemsCache[thisID] || extractKeyValues(root);\n        res(queryString ? itemsCache[thisID].filter(valuePredicate(queryString)) : itemsCache[thisID])\n    });\n}\n\nfunction elementAttached() {\n    itemsCache[this.id] = null;\n}\n\nfunction elementDetached() {\n    itemsCache[this.id] = null;\n}\n\nexport default function() {\n    try {\n        return document.registerElement('as24-tags-data-source', {\n            prototype: Object.assign(\n            Object.create(HTMLElement.prototype, {\n                attachedCallback: { value: elementAttached },\n                detachedCallback: { value: elementDetached },\n                attributeChangedCallback: { value: function () { } }\n            }), {\n                fetchItems: fetchItems\n            }\n        )\n        });\n    } catch(e) {\n        return null;\n    }\n}\n","import input from './as24-autocomplete-input';\nimport tagsDataSource from './data-sources/tags-data-source';\n\nexport default (function init() {\n    const inputCtr = input();\n    const tagsDataSourceCtr = tagsDataSource();\n    return {inputCtr, tagsDataSourceCtr};\n})();\n"],"names":["closestByClassName","elem","classList","contains","className","parentElement","$","selector","root","querySelector","on","event","cb","el","capturing","addEventListener","appendTo","appendChild","child","target","showList","add","list","hideList","rootElement","remove","isListVisible","renderLI","li","document","createElement","searchValue","searchStr","resultValue","item","value","replace","RegExp","key","innerHTML","length","renderEmptyListItem","innerText","emptyMessage","renderList","labelInput","df","createDocumentFragment","itemsModel","map","forEach","fetchList","dataSource","stopPropagation","fetchItems","then","selectItem","valueInput","onItemClicked","e","followSelectedItem","selected","listHeight","getBoundingClientRect","height","selectedTop","offsetTop","selectedHeight","offsetHeight","scrollTop","onItemMouseOver","preselected","tagName","moveSelection","dir","next","currActiveItem","nextActiveItem","onKeyDown","indexOf","which","preventDefault","onKeyUp","emptyListMessage","elementAttached","getAttribute","dataSourceName","arrow","focus","window","elementDetached","registerElement","Object","assign","create","HTMLElement","prototype","console","warn","itemsCache","extractKeyValues","Array","slice","call","querySelectorAll","tag","valuePredicate","match","queryString","thisID","id","Promise","filter","init","inputCtr","input","tagsDataSourceCtr","tagsDataSource"],"mappings":"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"}