{"version":3,"file":"as24-autocomplete.js","sources":["../src/as24-autocomplete-input.js","../src/data-sources/tags-data-source.js","../src/as24-autocomplete.js"],"sourcesContent":["'use strict';\n\n/**\n * Selects an element using the root element.\n * @param {string} selector\n * @param {Element} root\n */\nconst $ = (selector, root) => root.querySelector(selector);\n\n/**\n * Binds an event listener on the element\n * @param event\n * @param cb\n * @param el\n */\nconst on = (event, cb, el) => el.addEventListener(event, cb);\n\n/**\n * Appends a child element to a target element\n * @param target\n */\nconst appendTo = target => child => {\n    target.appendChild(child);\n    return target;\n};\n\n/**\n * Shows the suggestions list\n * @param {Element} list\n * @return {boolean}\n */\nconst showList = list => {\n    list.classList.add('as24-autocomplete__list--visible');\n    moveSelection(1, list);\n    return false;\n};\n\n/**\n * Hides the list and deactivates the root elment\n * @param {Element} list\n * @param {Element} rootElement\n */\nconst hideList = (list, rootElement) => e => {\n    rootElement.classList.remove('as24-autocomplete--active');\n    list.classList.remove('as24-autocomplete__list--visible');\n    return false;\n};\n\n/**\n * Checks whether the list is visisible\n * @param {Element} list\n */\nconst isListVisible = list =>\n    list.classList.contains('as24-autocomplete__list--visible');\n\n/**\n * Renders a li item for the suggestions list\n * @param {{key: string, value: string}} item\n * @param {string} searchInput\n * @returns {HTMLElement} {Element}\n */\nconst renderLI = searchInput => item => {\n    const li = document.createElement('li');\n    const searchValue = searchInput;\n    const resultValue = item.value.replace(new RegExp('^' + searchValue, 'gi'), '');\n    li.classList.add('as24-autocomplete__list-item');\n    li.key = item.key;\n    (li.innerHTML = searchInput.length\n        ? searchValue + '<b>' + resultValue + '</b>'\n        : resultValue);\n    return li;\n};\n\n/**\n * What to render when there is nothing to suggest\n * @param {String} emptyMessage\n * @return {Element}\n */\nconst renderEmptyListItem = emptyMessage => {\n    const li = document.createElement('li');\n    li.classList.add('as24-autocomplete__list-item');\n    li.key = '';\n    li.innerText = emptyMessage;\n    return li;\n};\n\n/**\n * Renders a collection of raw suggestions to the list\n * @param {string} emptyMessage\n * @param {HTMLElement} list\n * @param {Element} labelInput\n * @returns {Function}\n */\nconst renderList = (emptyMessage, list, labelInput) => itemsModel => {\n    list.innerHTML = '';\n    const df = document.createDocumentFragment();\n    (itemsModel.length\n            ? itemsModel.map(renderLI(labelInput.value, list))\n            : [renderEmptyListItem(emptyMessage)]\n    ).forEach(appendTo(df));\n    list.classList[itemsModel.length ? 'remove' : 'add']('as24-autocomplete__list--empty');\n    appendTo(list)(df);\n    showList(list);\n};\n\n/**\n * Fetch data according to user input and renders the list\n * @param {Element} dataSource\n * @param {HTMLInputElement} labelInput\n * @param {Element} list\n * @param {String} emptyMessage\n * @param {Element} rootElement\n */\nconst fetchList = (dataSource, labelInput, list, emptyMessage, rootElement) => e => {\n    e.stopPropagation();\n    rootElement.classList.add('as24-autocomplete--active');\n    dataSource.fetchItems(labelInput.value).then(renderList(emptyMessage, list, labelInput));\n};\n\n/**\n * This is what happens after the user selected an item\n * @param valueInput\n * @param labelInput\n * @param li\n */\nconst selectItem = (valueInput, labelInput, li) => {\n    valueInput.value = li.key;\n    labelInput.value = li.innerText;\n};\n\n/**\n * This is what happens then user clicked in the suggestion item\n * @param valueInput\n * @param labelInput\n * @param list\n * @param rootElement\n */\nconst onItemClicked = (valueInput, labelInput, list, rootElement) => e => {\n    selectItem(valueInput, labelInput, e.target);\n    hideList(list, rootElement)(e);\n};\n\n/**\n *\n * @param {HTMLElement} list\n * @param {HTMLElement} selected\n */\nconst followSelectedItem = (list, selected) => {\n    const listHeight = list.getBoundingClientRect().height;\n    const selectedTop = selected.offsetTop;\n    const selectedHeight = selected.offsetHeight;\n    list.scrollTop = -1 * (listHeight - (selectedTop + selectedHeight));\n};\n\n/**\n * When mouse goes over the suggestion item\n * @param list\n */\nconst onItemMouseOver = list => e => {\n    const currActiveItem = $('.as24-autocomplete__list-item--selected', list);\n    const mouseOverElement = e.target;\n    currActiveItem.classList.remove('as24-autocomplete__list-item--selected');\n    mouseOverElement.classList.add('as24-autocomplete__list-item--selected');\n};\n\n/**\n * Selected next/prev suggestion item\n * @param {number} dir\n * @param {Element} list\n * @return {boolean}\n */\nconst moveSelection = (dir, list) => {\n    const next = dir === 1 ? 'nextSibling' : 'previousSibling';\n    const currActiveItem = $('.as24-autocomplete__list-item--selected', list);\n    const nextActiveItem = currActiveItem === null\n        ? $('.as24-autocomplete__list-item', list)\n        : !!currActiveItem[next]\n        ? currActiveItem[next]\n        : currActiveItem;\n    currActiveItem && currActiveItem.classList.remove('as24-autocomplete__list-item--selected');\n    nextActiveItem.classList.add('as24-autocomplete__list-item--selected');\n    followSelectedItem(list, nextActiveItem);\n    return false;\n};\n\n/**\n * Handles key down\n * @param dataSource\n * @param valueInput\n * @param labelInput\n * @param list\n * @param rootElement\n */\nconst onKeyDown = (dataSource, valueInput, labelInput, list, rootElement) => e => {\n    if (e.target === labelInput) {\n        if ([38, 40, 27].indexOf(e.which) >= 0) {\n            e.stopPropagation();\n            e.preventDefault();\n        }\n        if (e.which === 38) {\n            return moveSelection(-1, list);\n        }\n        if (e.which === 40) {\n            return isListVisible(list) ? moveSelection(1, list) : showList(list);\n        }\n        if (e.which === 27) {\n            return hideList(list, rootElement)();\n        }\n    }\n};\n\n/**\n * Handles key up\n * @param dataSource\n * @param valueInput\n * @param labelInput\n * @param list\n * @param emptyListMessage\n * @param rootElement\n */\nconst onKeyUp = (dataSource, valueInput, labelInput, list, emptyListMessage, rootElement) => e => {\n    e.stopPropagation();\n    if (e.which === 13) {\n        selectItem(valueInput, labelInput, $('.as24-autocomplete__list-item--selected', list));\n        hideList(list, rootElement)();\n        return;\n    }\n    if ([38, 40, 27].indexOf(e.which) === -1) {\n        return fetchList(dataSource, labelInput, list, emptyListMessage, rootElement)(e);\n    }\n};\n\nfunction elementAttached() {\n    const emptyListMessage = this.getAttribute('empty-list-message') || \"---\";\n    const dataSourceName = this.getAttribute('data-source');\n    if (!dataSourceName) {\n        throw \"The data source is missing\";\n    }\n    const labelInput = $('[type=text]', this);\n    const valueInput = $('[type=hidden]', this);\n    const list = $('.as24-autocomplete__list', this);\n\n    const dataSource = $('#' + dataSourceName, document);\n    const fetchListCallback = fetchList(dataSource, labelInput, list, emptyListMessage, this);\n\n    on('click', hideList(list, this), document);\n    on('click', fetchListCallback, labelInput);\n    on('click', onItemClicked(valueInput, labelInput, list, this), list);\n    on('keyup', onKeyUp(dataSource, valueInput, labelInput, list, emptyListMessage, this), labelInput);\n    on('keydown', onKeyDown(dataSource, valueInput, labelInput, list, this), window);\n    on('mouseover', onItemMouseOver(list), list);\n}\n\nfunction elementDetached() {\n}\n\nexport default function () {\n    try {\n        return document.registerElement('as24-autocomplete', {\n            prototype: Object.assign(\n                Object.create(HTMLElement.prototype, {\n                    attachedCallback: {value: elementAttached},\n                    detachedCallback: {value: elementDetached},\n                    attributeChangedCallback: {\n                        value: function () {\n                        }\n                    }\n                })\n            )\n        });\n    } catch (e) {\n        if (window && window.console) {\n            window.console.warn('Failed to register CustomElement \"as24-autocomplete\".', e);\n            return null;\n        }\n    }\n}\n","var itemsCache = {};\n\nconst extractKeyValues = root =>\n  Array.prototype.slice.call(root.querySelectorAll('item')).map(tag => ({\n      key: tag.getAttribute('key'),\n      value: tag.getAttribute('value')\n  }));\n\nconst valuePredicate = queryString => item =>\n  item.value.match(new RegExp('^' + queryString, 'ig')) !== null;\n\nfunction fetchItems(queryString) {\n    var root = this;\n    var thisID = root.id;\n    return new Promise(res => {\n        itemsCache[thisID] = itemsCache[thisID] || extractKeyValues(root);\n        res(queryString ? itemsCache[thisID].filter(valuePredicate(queryString)) : itemsCache[thisID])\n    });\n}\n\nfunction elementAttached() {\n    itemsCache[this.id] = null;\n}\n\nfunction elementDetached() {\n    itemsCache[this.id] = null;\n}\n\nexport default function() {\n    try {\n        return document.registerElement('as24-tags-data-source', {\n            prototype: Object.assign(\n            Object.create(HTMLElement.prototype, {\n                attachedCallback: { value: elementAttached },\n                detachedCallback: { value: elementDetached },\n                attributeChangedCallback: { value: function () { } }\n            }), {\n                fetchItems: fetchItems\n            }\n        )\n        });\n    } catch(e) {\n        return null;\n    }\n}\n","import input from './as24-autocomplete-input';\nimport tagsDataSource from './data-sources/tags-data-source';\n\nexport default (function init() {\n    const inputCtr = input();\n    const tagsDataSourceCtr = tagsDataSource();\n    return {inputCtr, tagsDataSourceCtr};\n})();\n"],"names":["$","selector","root","querySelector","on","event","cb","el","addEventListener","appendTo","appendChild","child","target","showList","classList","add","list","hideList","rootElement","remove","isListVisible","contains","renderLI","li","document","createElement","searchValue","searchInput","resultValue","item","value","replace","RegExp","key","innerHTML","length","renderEmptyListItem","innerText","emptyMessage","renderList","labelInput","df","createDocumentFragment","itemsModel","map","forEach","fetchList","dataSource","stopPropagation","fetchItems","then","selectItem","valueInput","onItemClicked","e","followSelectedItem","selected","listHeight","getBoundingClientRect","height","selectedTop","offsetTop","selectedHeight","offsetHeight","scrollTop","onItemMouseOver","currActiveItem","mouseOverElement","moveSelection","dir","next","nextActiveItem","onKeyDown","indexOf","which","preventDefault","onKeyUp","emptyListMessage","elementAttached","getAttribute","dataSourceName","fetchListCallback","window","elementDetached","registerElement","Object","assign","create","HTMLElement","prototype","console","warn","itemsCache","extractKeyValues","Array","slice","call","querySelectorAll","tag","valuePredicate","match","queryString","thisID","id","Promise","filter","init","inputCtr","input","tagsDataSourceCtr","tagsDataSource"],"mappings":"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"}